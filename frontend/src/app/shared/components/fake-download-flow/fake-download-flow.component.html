<!-- Download button (only after hasPaid && hasUploadedProof && isAdminApproved) -->
<button
  *ngIf="showButton"
  type="button"
  (click)="openModal()"
  class="w-full neon-button py-3 px-4 rounded-lg font-medium transition-all duration-300"
  style="min-height: 44px;"
>
  Download Product
</button>

<!-- Pending verification (exactly 5 seconds) -->
<div
  *ngIf="isPending"
  class="mt-3 rounded-lg border border-cyan-500/30 bg-black/30 p-4 transition-opacity duration-300"
>
  <div class="flex items-center space-x-3">
    <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-cyan-500"></div>
    <div class="text-sm text-cyan-200">Pending verification...</div>
  </div>
</div>

<!-- Contact message after pending -->
<div
  *ngIf="showContactMessage"
  class="mt-3 rounded-lg border border-pink-500/30 bg-black/30 p-4 transition-opacity duration-300"
>
  <p class="text-sm text-pink-200 font-medium">
    Contact the admin for further assistance
  </p>
</div>

<!-- Modal -->
<div
  *ngIf="showModal"
  class="fixed inset-0 z-50 flex items-center justify-center p-4"
  role="dialog"
  aria-modal="true"
>
  <!-- Backdrop -->
  <div
    class="absolute inset-0 bg-black/70 backdrop-blur-sm"
    (click)="closeModal()"
  ></div>

  <!-- Panel -->
  <div
    class="relative w-full max-w-md rounded-xl border border-cyan-500/40 bg-gray-900 shadow-2xl"
    style="box-shadow: 0 0 30px rgba(0, 255, 255, 0.2);"
  >
    <div
      class="px-6 py-4 border-b border-cyan-500/30"
      style="background: linear-gradient(135deg, rgba(0, 255, 255, 0.1), rgba(157, 0, 255, 0.1));"
    >
      <h3 class="text-lg font-semibold text-cyan-200">Enter your email</h3>
      <p class="text-xs text-gray-300 mt-1">
        Weâ€™ll send a request to the admin. No direct download is provided.
      </p>
    </div>

    <div class="px-6 py-5">
      <label class="block text-sm font-medium text-cyan-200 mb-2" for="downloadEmail">
        Email address
      </label>
      <input
        id="downloadEmail"
        type="email"
        [(ngModel)]="email"
        (input)="validateEmail()"
        (blur)="validateEmail()"
        class="w-full rounded-lg bg-gray-800 px-4 py-3 text-gray-100 border focus:outline-none focus:ring-2 focus:ring-cyan-500 transition-all"
        [class.border-red-500]="!!emailError"
        [class.border-cyan-500]="!emailError"
        placeholder="you@example.com"
        style="min-height: 44px;"
      />
      <p
        *ngIf="emailError"
        class="mt-2 text-sm text-red-400"
        style="text-shadow: 0 0 5px #ef4444;"
      >
        {{ emailError }}
      </p>
    </div>

    <div
      class="px-6 py-4 border-t border-cyan-500/30 flex items-center justify-end gap-3"
      style="background: linear-gradient(135deg, rgba(0, 255, 255, 0.05), rgba(157, 0, 255, 0.05));"
    >
      <button
        type="button"
        (click)="closeModal()"
        class="px-4 py-2 rounded-lg text-gray-200 hover:bg-gray-800 transition-colors"
        style="min-height: 44px; min-width: 90px;"
      >
        Cancel
      </button>
      <button
        type="button"
        (click)="submitAndRequestDownload()"
        class="neon-button px-5 py-2 rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed"
        [disabled]="!email || !!emailError"
        style="min-height: 44px; min-width: 120px;"
      >
        Download
      </button>
    </div>
  </div>
</div>

